@using Cinema.Shared.DTO
@inherits ComponentBase

@if (Movie != null) 
{
    <div>
        <h1>Movie: @Movie.Name</h1>
        <img src="images/@(Movie.ID).jpg" width="200px"> @* Make sure all files are the same. EX: .jpg *@
        <p>Age Rating: @Movie.AgeRating</p>
        <p>Duration: @Movie.Duration</p>
        <p>Description: @Movie.Description</p>

        <iframe width="100%" height="100%" src="https://www.youtube.com/embed/@Movie.Trailer" 
            title="YouTube video player" 
            frameborder="0" 
            allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" 
            allowfullscreen>
        </iframe>
    </div>
}

@code {
    [Parameter]
    public int MovieID { get; set; }
    private const string API_URL = "api/movie";
    private HttpClient _client;
    public MovieDTO Movie { get; set; }


    protected override async Task OnInitializedAsync()
    {
        _client = new HttpClient() { BaseAddress = new Uri("https://localhost:7016") };
        Movie = await GetMovieAsync();
    }

    public async Task<MovieDTO> GetMovieAsync()
    {
        return await _client.GetFromJsonAsync<MovieDTO>(API_URL + $"/movies/{MovieID}");
    }
}
