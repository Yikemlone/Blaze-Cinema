@using Cinema.Shared.DTO
@inherits ComponentBase

@if(SeatScreenings != null) {
    <MudContainer MaxWidth="MaxWidth.Small">
        <MudPaper>
            <MudGrid Style="width: 300px">
                @foreach (var seat in SeatScreenings)
                {
                    <MudItem Style="padding: 0px">
                        <Seat OnSeatSelected="SeatSelected" SeatScreening="@seat"/>
                    </MudItem>
                }

                Screen Here

            </MudGrid>

            <MudButton Variant="Variant.Filled" ButtonType="ButtonType.Button" Color="Color.Secondary" OnClick="OnSelected">
                Save Seats
            </MudButton>
        </MudPaper>
    </MudContainer>
}

@code {
    [Parameter] public List<SeatScreeningDTO> SeatScreenings { get; set; }
    [Parameter] public EventCallback<List<SeatScreeningDTO>> OnSeatsSelected { get; set; }

    private List<SeatScreeningDTO> _selectedSeats = new();

    protected async Task SeatSelected(SeatScreeningDTO seat)
    {
        // This will set the selected seat, unless its already in the list
        // which then it will remove it 
        if (_selectedSeats.Contains(seat))
        {
            _selectedSeats.Remove(seat);
        }
        else 
        {
            _selectedSeats.Add(seat);
        }
    }

    protected async Task OnSelected() 
    {
        // This will send all the selected seats page to booking page.
        await OnSeatsSelected.InvokeAsync(_selectedSeats);
    }
}
